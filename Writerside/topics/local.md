# Локальные переменные

Переменные, которые живут и умирают внутри функции. Должны быть объявлены до любого действия внутри функции с помощью
ключевого слова `local`:

```SQL
function main takes nothing returns nothing
    local integer a = 1
    local real b
endfunction
```

Должны быть объявлены до первого действия в функции.

> На уровне языка локальные переменные являются [аргументами](arguments.md), которые не передаются извне.

## Утечка {id="leak"}

Она же _уточка_, она же [memory leak](https://w.wiki/9jpZ), это не освобождённая память. Возникает по двум причинам:
- не удалённые объекты
- локальные переменные с типом, наследуемым от [](handle.md)

Первая причина проста - любой созданный объект необходимо удалить после использования.

```SQL
function SomeTriggerAction takes nothing returns nothing
    local location rally = GetUnitRallyPoint(GetTriggerUnit())
    // делаем что-то с полученной точкой
    call RemoveLocation(rally) // удаляем созданную точку после использования
    set rally = null // об этом ниже
endfunction
```

Вторая причина не интуитивна и заключается в рукожопости создателей языка. Более подробно это
описано [здесь](https://xgm.guru/p/wc3/Jass-MythBusters).

Чтоб их избежать достаточно запомнить простое правило: в момент выхода из функции всем локальным переменным с типом
наследующим [](handle.md) должно быть установлено значение [](null.md).

> Это ошибка языка и относится **только** к локальным переменным. Ни [глобальные перемененные](globals.md),
> ни [аргументы функции](arguments.md) этой ошибке не подвержены.
